---
apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization
labels:
  - pairs:
      app.kubernetes.io/name: github-stats-exporter
      app.kubernetes.io/instance: github-stats-exporter
      app.kubernetes.io/version: "0.0.0"
      app.kubernetes.io/part-of: github-stats-exporter
      app.kubernetes.io/managed-by: kustomize
    includeSelectors: false
    includeTemplates: true
resources:
  - ../../base
  - redis-sentinel.yaml
  - redis-replicas-statefulset.yaml
  - networkpolicy.yaml
patchesStrategicMerge:
  - patch-scale.yaml
  - patch-config.yaml
  - patch-app-hardening.yaml
secretGenerator:
  # Copy the example files under secrets/ to the filenames below before deploying.
  - name: github-stats-exporter-secrets
    options:
      labels:
        app.kubernetes.io/component: exporter
    files:
      - org-a.pem=secrets/github/org-a.pem
      - org-b.pem=secrets/github/org-b.pem
  - name: rabbitmq-secret
    options:
      labels:
        app.kubernetes.io/component: rabbitmq
    files:
      - username=secrets/rabbitmq/username
      - password=secrets/rabbitmq/password
      - erlang-cookie=secrets/rabbitmq/erlang-cookie
generatorOptions:
  # Keep stable secret names so existing secretKeyRef and volume mounts continue to work.
  disableNameSuffixHash: true
